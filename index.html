<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema Oficina Wesley Lisboa</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>

/* ======= BASE BONITA ANTIGA ======= */
body{
 font-family:Arial, sans-serif;
 background:#f2f2f2;
 margin:0;
}

header{
 background:#0d6efd;
 color:white;
 padding:15px;
 text-align:center;
}

header img{
 width:130px;
 border-radius:12px;
 box-shadow:0 0 10px rgba(0,0,0,0.3);
}

h2,h3{
 margin:5px 0;
}

.menu{
 background:#0d6efd;
 padding:10px;
 display:flex;
 flex-wrap:wrap;
 gap:6px;
 justify-content:center;
}

.menu button{
 background:white;
 color:#0d6efd;
 border:none;
 padding:8px 10px;
 border-radius:8px;
 font-weight:bold;
 font-size:13px;
}

.menu button:hover{
 background:#cfe2ff;
}

.section{
 background:white;
 margin:10px;
 padding:15px;
 border-radius:14px;
 box-shadow:0 4px 12px rgba(0,0,0,0.15);
 display:none;
 animation:fade 0.3s;
}

@keyframes fade{
 from{opacity:0;transform:translateY(10px);}
 to{opacity:1;transform:translateY(0);}
}

button{
 background:#0d6efd;
 color:white;
 border:none;
 padding:10px;
 border-radius:8px;
 font-weight:bold;
 margin-top:5px;
}

button:hover{
 background:#084298;
}

input,select,textarea{
 width:100%;
 padding:8px;
 margin:5px 0;
 border-radius:6px;
 border:1px solid #ccc;
 font-size:14px;
}

.alert{
 padding:10px;
 border-radius:8px;
 margin:6px 0;
 color:white;
 font-weight:bold;
}

.red{background:#dc3545;}
.orange{background:#fd7e14;}
.green{background:#198754;}

.badge{
 padding:4px 8px;
 border-radius:20px;
 font-size:12px;
 color:white;
 font-weight:bold;
}

.badge.red{background:red;}
.badge.green{background:green;}
.badge.blue{background:#0d6efd;}

.login-box{
 text-align:center;
 padding:50px;
}

/* iPhone otimizaÃ§Ã£o */
@media(max-width:600px){
 .menu button{font-size:11px;padding:6px;}
}

</style>
</head>

<body>

<!-- ğŸ”’ LOGIN -->
<div id="login" class="login-box">
<h2>ğŸ”’ Sistema Oficina Wesley Lisboa</h2>
<p>Digite a senha para acessar</p>
<input id="senha" type="password" placeholder="Senha">
<button onclick="entrar()">Entrar</button>
<p id="msgLogin"></p>
</div>

<!-- ===== APP PRINCIPAL ===== -->
<div id="app" style="display:none;">

<header>
<!-- SUA LOGO (NOME REAL) -->
<img src="B1BCC237-7C89-4142-8131-6DA05C2A2C61%202.png">
<h2>Oficina Wesley Lisboa</h2>
<p>Sistema Profissional de GestÃ£o</p>
</header>

<!-- MENU MASTER -->
<div class="menu">
<button onclick="show('dashboard')">ğŸ“Š Dashboard</button>
<button onclick="show('servicos')">ğŸ”§ ServiÃ§os</button>
<button onclick="show('historico')">ğŸ“œ HistÃ³rico</button>
<button onclick="show('oleo')">ğŸ›¢ï¸ Troca de Ã“leo</button>
<button onclick="show('pagamentos')">ğŸ’³ Pagamentos</button>
<button onclick="show('estoque')">ğŸ“¦ Estoque</button>
<button onclick="show('contas')">ğŸ“‘ Contas</button>
<button onclick="show('agenda')">ğŸ“… Agenda</button>
<button onclick="show('metas')">ğŸ¯ Metas</button>
<button onclick="show('whatsapp')">ğŸ’¬ WhatsApp</button>
<button onclick="show('backup')">ğŸ’¾ Backup</button>
</div>

<!-- ===== SEÃ‡Ã•ES (VAZIAS AINDA, VEM NA PARTE B) ===== -->

<div id="dashboard" class="section">
<h3>ğŸ“Š Dashboard Geral</h3>
<canvas id="graficoLucro"></canvas>
<div id="alertasSistema"></div>
</div>

<div id="servicos" class="section"></div>
<div id="historico" class="section"></div>
<div id="oleo" class="section"></div>
<div id="pagamentos" class="section"></div>
<div id="estoque" class="section"></div>
<div id="contas" class="section"></div>
<div id="agenda" class="section"></div>
<div id="metas" class="section"></div>
<div id="whatsapp" class="section"></div>
<div id="backup" class="section"></div>

<script>
/* ===== LOGIN ===== */
function entrar(){
 let s=document.getElementById("senha").value;
 if(s=="2026"){
  document.getElementById("login").style.display="none";
  document.getElementById("app").style.display="block";
  show("dashboard");
 }else{
  document.getElementById("msgLogin").innerHTML="âŒ Senha errada";
 }
}

/* ===== MENU ===== */
function show(id){
 document.querySelectorAll(".section").forEach(s=>s.style.display="none");
 document.getElementById(id).style.display="block";
}
</script>

</div>
</body>
</html>
<!-- DASHBOARD -->
<div id="dashboard" class="section active">
  <h2>ğŸ“Š Painel da Oficina</h2>
  <div class="cards">
    <div class="card">ğŸ’° Lucro: R$ <span id="lucroTotal">0</span></div>
    <div class="card">ğŸ“¦ PeÃ§as em estoque: <span id="qtdEstoque">0</span></div>
    <div class="card">ğŸ“… ServiÃ§os Hoje: <span id="servicosHoje">0</span></div>
  </div>
  <canvas id="graficoLucro"></canvas>
</div>

<!-- SERVIÃ‡OS -->
<div id="servicos" class="section">
  <h2>ğŸ”§ Registrar ServiÃ§o</h2>
  <input id="sCliente" placeholder="Cliente">
  <input id="sPlaca" placeholder="Placa">
  <input id="sDescricao" placeholder="ServiÃ§o realizado">
  <input id="sValor" type="number" placeholder="Valor R$">

  <select id="sPagamento">
    <option>PIX</option>
    <option>CartÃ£o CrÃ©dito</option>
    <option>CartÃ£o DÃ©bito</option>
    <option>Dinheiro</option>
  </select>

  <button onclick="addServico()">Salvar ServiÃ§o</button>
  <div id="listaServicos"></div>
</div>

<!-- HISTÃ“RICO -->
<div id="historico" class="section">
  <h2>ğŸ“œ HistÃ³rico de ServiÃ§os</h2>
  <input id="filtroCliente" placeholder="Buscar cliente">
  <input id="filtroPlaca" placeholder="Buscar placa">
  <button onclick="filtrarHistorico()">Filtrar</button>
  <div id="listaHistorico"></div>
</div>

<!-- TROCA DE Ã“LEO -->
<div id="oleo" class="section">
  <h2>ğŸ›¢ï¸ Controle de Troca de Ã“leo</h2>
  <input id="oCliente" placeholder="Cliente">
  <input id="oPlaca" placeholder="Placa">
  <input id="oData" type="date">
  <input id="oKm" type="number" placeholder="KM atual">
  <button onclick="addOleo()">Registrar</button>
  <div id="listaOleo"></div>
</div>

<!-- CONTAS -->
<div id="contas" class="section">
  <h2>ğŸ“‘ Contas a Pagar</h2>
  <input id="cNome" placeholder="Nome da conta">
  <input id="cValor" type="number" placeholder="Valor">
  <input id="cData" type="date">
  <button onclick="addConta()">Adicionar</button>
  <div id="listaContas"></div>
</div>

<!-- ESTOQUE -->
<div id="estoque" class="section">
  <h2>ğŸ“¦ Controle de Estoque</h2>
  <input id="ePeca" placeholder="Nome da peÃ§a">
  <input id="eQtd" type="number" placeholder="Quantidade">
  <button onclick="addEstoque()">Adicionar</button>
  <div id="listaEstoque"></div>
</div>

<!-- AGENDA -->
<div id="agenda" class="section">
  <h2>ğŸ“… Agenda da Oficina</h2>
  <input id="aCliente" placeholder="Cliente">
  <input id="aData" type="date">
  <button onclick="addAgenda()">Agendar</button>
  <div id="listaAgenda"></div>
</div>

<!-- METAS -->
<div id="metas" class="section">
  <h2>ğŸ¯ Metas Mensais</h2>
  <input id="metaLucroInput" type="number" placeholder="Meta de lucro R$">
  <button onclick="salvarMeta()">Salvar Meta</button>
  <div id="barraMeta"></div>
</div>

<!-- TAXAS -->
<div id="taxas" class="section">
  <h2>ğŸ’³ Taxas de Pagamento</h2>
  <ul>
    <li>PIX: 0%</li>
    <li>Dinheiro: 0%</li>
    <li>CartÃ£o DÃ©bito: 2%</li>
    <li>CartÃ£o CrÃ©dito: 12%</li>
  </ul>
</div>

<!-- WHATSAPP -->
<div id="whatsapp" class="section">
  <h2>ğŸ’¬ Mensagens WhatsApp</h2>
  <textarea id="wppMsg" rows="4">OlÃ¡, sua revisÃ£o estÃ¡ agendada na Oficina Wesley Lisboa!</textarea>
  <button onclick="copiarWpp()">Copiar Mensagem</button>
</div>

<!-- BACKUP -->
<div id="backup" class="section">
  <h2>ğŸ’¾ Backup e RestauraÃ§Ã£o</h2>
  <button onclick="exportarDados()">Exportar Backup</button>
  <input type="file" onchange="importarDados(event)">
</div>

<!-- CHECKLIST -->
<div id="checklist" class="section">
  <h2>âœ… Check-list de VeÃ­culo</h2>
  <textarea id="checkText" placeholder="Freios OK, Ã³leo trocado, bateria..."></textarea>
  <button onclick="salvarCheck()">Salvar Check</button>
  <div id="listaCheck"></div>
</div>

<!-- IA -->
<div id="ia" class="section">
  <h2>ğŸ¤– IA da Oficina</h2>
  <input id="iaPergunta" placeholder="Pergunte algo...">
  <button onclick="responderIA()">Perguntar</button>
  <div id="iaResposta"></div>
</div>
<script>
/* ================= BANCO LOCAL ================= */
let servicos = JSON.parse(localStorage.getItem("servicos")) || [];
let oleos = JSON.parse(localStorage.getItem("oleos")) || [];
let estoque = JSON.parse(localStorage.getItem("estoque")) || [];
let contas = JSON.parse(localStorage.getItem("contas")) || [];
let agenda = JSON.parse(localStorage.getItem("agenda")) || [];
let checks = JSON.parse(localStorage.getItem("checks")) || [];
let metaLucro = localStorage.getItem("metaLucro") || 0;

/* ================= SALVAR ================= */
function salvarTudo() {
  localStorage.setItem("servicos", JSON.stringify(servicos));
  localStorage.setItem("oleos", JSON.stringify(oleos));
  localStorage.setItem("estoque", JSON.stringify(estoque));
  localStorage.setItem("contas", JSON.stringify(contas));
  localStorage.setItem("agenda", JSON.stringify(agenda));
  localStorage.setItem("checks", JSON.stringify(checks));
  localStorage.setItem("metaLucro", metaLucro);
}

/* ================= SERVIÃ‡OS ================= */
function addServico() {
  let c = sCliente.value;
  let p = sPlaca.value;
  let d = sDescricao.value;
  let v = parseFloat(sValor.value || 0);
  let pag = sPagamento.value;

  if (!c || !p) return alert("Preencha cliente e placa");

  servicos.push({ c, p, d, v, pag, data: new Date().toLocaleDateString() });
  salvarTudo();
  listarServicos();
  atualizarDashboard();
}

function listarServicos() {
  listaServicos.innerHTML = "";
  servicos.forEach(s => {
    listaServicos.innerHTML += `<div class="alert green">${s.data} | ${s.c} | ${s.p} | R$ ${s.v} (${s.pag})</div>`;
  });
}

/* ================= HISTÃ“RICO ================= */
function filtrarHistorico() {
  let fc = filtroCliente.value.toLowerCase();
  let fp = filtroPlaca.value.toLowerCase();
  listaHistorico.innerHTML = "";

  servicos.filter(s =>
    s.c.toLowerCase().includes(fc) &&
    s.p.toLowerCase().includes(fp)
  ).forEach(s => {
    listaHistorico.innerHTML += `<div class="alert blue">${s.data} - ${s.c} - ${s.p} - R$${s.v}</div>`;
  });
}

/* ================= Ã“LEO ================= */
function addOleo() {
  oleos.push({ c: oCliente.value, p: oPlaca.value, d: oData.value, km: oKm.value });
  salvarTudo();
  listarOleo();
}

function listarOleo() {
  listaOleo.innerHTML = "";
  oleos.forEach(o => {
    listaOleo.innerHTML += `<div class="alert orange">${o.c} | ${o.p} | PrÃ³x: ${o.d}</div>`;
  });
}

/* ================= ESTOQUE ================= */
function addEstoque() {
  estoque.push({ p: ePeca.value, q: parseInt(eQtd.value) });
  salvarTudo();
  listarEstoque();
}

function listarEstoque() {
  listaEstoque.innerHTML = "";
  estoque.forEach(e => {
    let cor = e.q < 3 ? "red" : "green";
    listaEstoque.innerHTML += `<div class="alert ${cor}">${e.p} - QTD: ${e.q}</div>`;
  });
}

/* ================= CONTAS ================= */
function addConta() {
  contas.push({ n: cNome.value, v: cValor.value, d: cData.value });
  salvarTudo();
  listarContas();
}

function listarContas() {
  listaContas.innerHTML = "";
  let hoje = new Date().toISOString().split("T")[0];

  contas.forEach(c => {
    let cor = c.d < hoje ? "red" : "green";
    listaContas.innerHTML += `<div class="alert ${cor}">${c.n} - R$${c.v} - ${c.d}</div>`;
  });
}

/* ================= AGENDA ================= */
function addAgenda() {
  agenda.push({ c: aCliente.value, d: aData.value });
  salvarTudo();
  listarAgenda();
}

function listarAgenda() {
  listaAgenda.innerHTML = "";
  agenda.forEach(a => {
    listaAgenda.innerHTML += `<div class="alert blue">${a.c} - ${a.d}</div>`;
  });
}

/* ================= METAS ================= */
function salvarMeta() {
  metaLucro = metaLucroInput.value;
  salvarTudo();
  atualizarDashboard();
}

function atualizarMetaBarra(lucro) {
  if (!metaLucro) return;
  let perc = Math.min((lucro / metaLucro) * 100, 100);
  barraMeta.innerHTML = `<div style="background:#0d6efd;height:20px;width:${perc}%;border-radius:10px;color:white;text-align:center;">${Math.round(perc)}%</div>`;
}

/* ================= CHECKLIST ================= */
function salvarCheck() {
  checks.push(checkText.value);
  salvarTudo();
  listarCheck();
}

function listarCheck() {
  listaCheck.innerHTML = "";
  checks.forEach(c => listaCheck.innerHTML += `<div class="alert gray">${c}</div>`);
}

/* ================= WHATSAPP ================= */
function copiarWpp() {
  navigator.clipboard.writeText(wppMsg.value);
  alert("Mensagem copiada!");
}

/* ================= BACKUP ================= */
function exportarDados() {
  let dados = { servicos, oleos, estoque, contas, agenda, checks, metaLucro };
  let blob = new Blob([JSON.stringify(dados)], { type: "application/json" });
  let a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "backup_oficina.json";
  a.click();
}

function importarDados(e) {
  let file = e.target.files[0];
  let reader = new FileReader();
  reader.onload = () => {
    let d = JSON.parse(reader.result);
    servicos = d.servicos || [];
    oleos = d.oleos || [];
    estoque = d.estoque || [];
    contas = d.contas || [];
    agenda = d.agenda || [];
    checks = d.checks || [];
    metaLucro = d.metaLucro || 0;
    salvarTudo();
    alert("Backup restaurado!");
    location.reload();
  };
  reader.readAsText(file);
}

/* ================= DASHBOARD ================= */
function atualizarDashboard() {
  let lucro = servicos.reduce((t, s) => t + s.v, 0);
  lucroTotal.innerText = lucro;
  qtdEstoque.innerText = estoque.length;
  servicosHoje.innerText = servicos.filter(s => s.data == new Date().toLocaleDateString()).length;
  atualizarMetaBarra(lucro);
  atualizarGrafico();
}

/* ================= ALERTAS POP-UP ================= */
function verificarAlertas() {
  let hoje = new Date().toISOString().split("T")[0];

  contas.forEach(c => {
    if (c.d < hoje) alert("âš ï¸ Conta vencida: " + c.n);
  });

  estoque.forEach(e => {
    if (e.q < 3) alert("âš ï¸ Estoque baixo: " + e.p);
  });

  oleos.forEach(o => {
    if (o.d < hoje) alert("âš ï¸ Troca de Ã³leo vencida: " + o.p);
  });
}

/* ================= GRÃFICO PROFISSIONAL ================= */
let grafico;
function atualizarGrafico() {
  let ctx = document.getElementById("graficoLucro").getContext("2d");
  let labels = servicos.map(s => s.data);
  let data = servicos.map(s => s.v);

  if (grafico) grafico.destroy();

  grafico = new Chart(ctx, {
    type: "line",
    data: {
      labels: labels,
      datasets: [{
        label: "Lucro",
        data: data,
        borderColor: "#0d6efd",
        backgroundColor: "rgba(13,110,253,0.2)",
        fill: true
      }]
    }
  });
}

/* ================= IA SIMPLES ================= */
function responderIA() {
  let q = iaPergunta.value.toLowerCase();
  let r = "Pergunta interessante.";

  if (q.includes("lucro")) r = "Seu lucro atual Ã© R$ " + lucroTotal.innerText;
  if (q.includes("estoque")) r = "VocÃª tem " + estoque.length + " peÃ§as cadastradas.";
  if (q.includes("contas")) r = "VocÃª tem " + contas.length + " contas registradas.";

  iaResposta.innerText = r;
}

/* ================= MENU ================= */
function abrir(sec) {
  document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
  document.getElementById(sec).classList.add("active");
}

/* ================= INICIAR ================= */
listarServicos();
listarOleo();
listarEstoque();
listarContas();
listarAgenda();
listarCheck();
atualizarDashboard();
verificarAlertas();
</script>

<!-- CHART.JS (GRÃFICO) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
